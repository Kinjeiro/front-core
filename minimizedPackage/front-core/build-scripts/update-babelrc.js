const{writeToFile}=require("./utils/file-utils"),{tryLoadProjectFile}=require("./utils/require-utils"),context=tryLoadProjectFile("build-scripts/webpack-context"),WEBPACK_CONFIG_UTILS=tryLoadProjectFile("build-scripts/webpack-config"),isServer="server"===process.env.BABEL_MODE;console.log("Create .babelrc for",isServer?"SERVER":"CLIENT");const webpackConfig=isServer?WEBPACK_CONFIG_UTILS.getBackendWebpackConfig(context):WEBPACK_CONFIG_UTILS.getFrontendWebpackConfig(context),babelLoader=webpackConfig.module.rules.find(a=>"babel-loader"===a.loader),babelRcFinal={presets:babelLoader.options.presets,plugins:babelLoader.options.plugins,comments:babelLoader.options.comments,env:babelLoader.options.env};"test"===process.env.NODE_ENV&&babelRcFinal.plugins.push("babel-plugin-require-context-hook"),writeToFile(context.inProject(".babelrc"),babelRcFinal);