const fs=require("fs"),webpack=require("webpack"),{pathJoin}=require("../../utils/path-utils");function pluginBackendMain(a,{publicPath:b,serverStartPath:c,inProjectBuild:d,isLocalhost:e,ENV:f}){a.target="node",a.entry.server=[c],a.output.path=d(),a.output.publicPath=pathJoin("/",b),a.output.filename="server.js";const g={};fs.readdirSync("node_modules").filter(a=>-1===[".bin"].indexOf(a)).forEach(a=>{g[a]=`commonjs ${a}`}),Object.assign(a.externals,g),a.plugins.push(new webpack.NormalModuleReplacementPlugin(/\.(css|scss|less)/,"node-noop")),e&&(a.plugins.push(new webpack.BannerPlugin({banner:"require(\"source-map-support\").install();",raw:!0,entryOnly:!1})),!f.WATCH_CLIENT_FILES&&(a.watchOptions={ignored:[/node_modules[/\\](?!@reagentum)/,/[/\\]static[/\\]/,/[/\\]src[/\\]client[/\\]/,/[/\\]src[/\\]common[/\\]app-redux[/\\]/,/[/\\]src[/\\]common[/\\]app-style[/\\]/,/[/\\]src[/\\]common[/\\]app-styles[/\\]/,/[/\\]src[/\\]common[/\\]components[/\\]/,/[/\\]src[/\\]common[/\\]containers[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]static[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]pages[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]containers[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]components[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]subModule[/\\]pages[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]subModule[/\\]containers[/\\]/,/[/\\]src[/\\]modules[/\\]\S+[/\\]common[/\\]subModule[/\\]components[/\\]/]})),a.node={__dirname:!0}}module.exports=pluginBackendMain;